{% schema %}
{
  "name": "Borne RDC",
  "settings": [
    {
      "type": "text",
      "id": "categories",
      "label": "Catégories (séparées par des virgules)",
      "default": "T-shirts, Débardeurs, Sweatshirts",
      "info": "Les images associées doivent être nommées 'nom_categorie.webp'"
    },
    {
      "type": "collection_list",
      "id": "collections",
      "label": "Collections à afficher",
      "limit": 20
    },
    {
      "type": "textarea",
      "id": "collection_descriptions",
      "label": "Descriptions personnalisées des collections",
    },
    {
      "type": "collection",
      "id": "collection_1_2",
      "label": "Collection 2 de catégorie 1"
    },
    {
      "type": "text",
      "id": "category_2",
      "label": "Catégorie 2",
      "default": "Sweats"
    },
    {
      "type": "collection",
      "id": "collection_2_1",
      "label": "Collection 1 de catégorie 2"
    },
    {
      "type": "collection",
      "id": "collection_2_2",
      "label": "Collection 2 de catégorie 2"
    }
  ],
  "presets": [
    {
      "name": "Borne RDC",
      "category": "Collection"
    }
  ]
}
{% endschema %}

<div class="rdc-borne">
  <button class="rdc-borne__back-button" data-action="back">
    <span class="rdc-borne__back-icon">&larr;</span> Retour
  </button>

  <!-- Écran 1: Catégories -->
  <div class="rdc-borne__screen" data-screen="1" data-active="true">
    <div class="rdc-borne__content">
      <h1 class="rdc-borne__title">Choisissez votre catégorie</h1>
      <div class="rdc-borne__categories">
        {% assign categories = section.settings.categories | split: ',' %}
        {% for category in categories %}
          {% assign category_clean = category | strip %}
          <div class="rdc-borne__category" data-category="{{ category_clean | handleize }}">
            <div class="rdc-borne__category-inner">
              <img src="https://cdn.shopify.com/s/files/1/0728/9690/5483/files/{{ category_clean | handleize }}.webp?v=1755198090" alt="{{ category_clean }}" class="rdc-borne__category-image">
              <h2 class="rdc-borne__category-title">{{ category_clean }}</h2>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Écran 2 -->
  <div class="rdc-borne__screen" data-screen="2" data-active="false">
    <div class="rdc-borne__content">
      <h1>Deuxième écran</h1>
    </div>
    <button class="rdc-borne__next-button" data-action="next" data-target="3">Suivant</button>
  </div>

  <!-- Écran 3 -->
  <div class="rdc-borne__screen" data-screen="3" data-active="false">
    <div class="rdc-borne__content">
      <h1>Troisième écran</h1>
    </div>
    <button class="rdc-borne__next-button" data-action="next" data-target="4">Suivant</button>
  </div>

  <!-- Écran 4 -->
  <div class="rdc-borne__screen" data-screen="4" data-active="false">
    <div class="rdc-borne__content">
      <h1>Quatrième écran</h1>
    </div>
  </div>
</div>

<script type="application/json" id="rdc-borne-data">
  {
    "categories": [
      {% for i in (1..2) %}
        {% assign category_key = 'category_' | append: i %}
        {% assign category_name = section.settings[category_key] %}
        {% if category_name != blank %}
          {
            "id": {{ i }},
            "name": {{ category_name | json }},
            "collections": [
              {% for j in (1..2) %}
                {% assign collection_key = 'collection_' | append: i | append: '_' | append: j %}
                {% assign collection = section.settings[collection_key] %}
                {% if collection != blank %}
                  {
                    "id": {{ collection.id | json }},
                    "title": {{ collection.title | json }},
                    "handle": {{ collection.handle | json }}
                  }{% unless forloop.last %},{% endunless %}
                {% endif %}
              {% endfor %}
            ]
          }{% unless forloop.last %},{% endunless %}
        {% endif %}
      {% endfor %}
    ]
  }
</script>

{{ 'rdc_borne.css' | asset_url | stylesheet_tag }}
{{ 'rdc_borne.js' | asset_url | script_tag }}